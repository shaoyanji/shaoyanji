# https://taskfile.dev

version: "3"

vars:
  README: README.md
  PREFIX: "!["
  DOMAIN: "](https://img.shields.io/badge/"
  STYLE: "?style=for-the-badge&logo="
  SUFFIX: "&logoColor=white)"
  SOURCE: src/skills.yaml

tasks:
  gitpush:
    cmds:
      - git add . && git commit -m "updated README.md" && git push
  default:
    vars:
      USER:
        sh: yq '.name' {{.SOURCE}}
      TITLE:
        sh: yq '.title' {{.SOURCE}}
      STITLE:
        sh: yq '.subtitle' {{.SOURCE}}
    cmds:
      - echo '<p>&nbsp;<img align="center" src="https://readmestats.999857.xyz/api?username={{.USER}}&show_icons=true&locale=en&theme=tokyonight" alt="{{.USER}} stats" /></p>' > {{.README}}
      - echo "" >> {{.README}}
      - echo "{{.TITLE}}"  >>{{.README}}
      - echo "{{.STITLE}}" >> {{.README}}
      # - echo "#### 🙈 - Frontend:" >> {{.README}}
      - echo "" >> {{.README}}
      - task category:frontend
      # - echo "#### 🙉 - Backend:" >> {{.README}}
      - task category:backend
      # - echo "#### 🙊 - Database:" >> {{.README}}
      - task category:database
      # - echo "#### 🐵 - Hosting Services and Web Tools:" >> {{.README}}
      - task category:hosting
      # - echo "### DevOps ♾️:" >> {{.README}}
      - task category:devops
      # - echo "### Others:" >> {{.README}}
      - task category:others
      # - echo "### IDEs and Tools 🛠:" >> {{.README}}
      - task category:ide
      - task gitpush
  category:*:
    vars:
      CATEG: "{{index .MATCH 0}}"
      SIZE:
        sh: yq '.{{.CATEG}}.[1].list.[]|key' {{.SOURCE}}
      TITLE:
        sh: yq '.{{.CATEG}}.[0].title' {{.SOURCE}}
    cmds:
      - echo "{{.TITLE}}" >> {{.README}}
      - for: { var: SIZE }
        cmd: echo "{{.PREFIX}}$(task skill:{{.CATEG}}:{{.ITEM}}){{.DOMAIN}}$(task skill:{{.CATEG}}:{{.ITEM}})-$(task color:{{.CATEG}}:{{.ITEM}}){{.STYLE}}$(task skill:{{.CATEG}}:{{.ITEM}}){{.SUFFIX}}" >> {{.README}}

  skill:*:*:
    vars:
      CATEG: "{{index .MATCH 0}}"
      INDEX: "{{index .MATCH 1}}"
    cmds:
      - yq '.{{.CATEG}}.{{.INDEX}}.[]|key' {{.SOURCE}}
      # - yq '.{{.CATEG}}.{{.INDEX}}.[]' {{.SOURCE}}

  color:*:*:
    vars:
      CATEG: "{{index .MATCH 0}}"
      INDEX: "{{index .MATCH 1}}"
    cmds:
      # - yq '.{{.CATEG}}.{{.INDEX}}.[]|key' {{.SOURCE}}
      - yq '.{{.CATEG}}.{{.INDEX}}.[]' {{.SOURCE}}
